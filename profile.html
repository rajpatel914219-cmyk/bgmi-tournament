<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Profile</title>

<style>

/* ===============================
   GLOBAL STYLE
================================ */

body{
  margin:0;
  font-family:Arial, sans-serif;
  background:linear-gradient(180deg,#020617,#0f172a);
  color:white;
  overflow-x:hidden;
}

/* ===============================
   HEADER
================================ */

.header{
  padding:18px;
  text-align:center;
  font-size:20px;
  font-weight:bold;
  color:#22c55e;
}

/* ===============================
   PROFILE CARD
================================ */

.profile-card{
  margin:15px;
  background:rgba(255,255,255,0.05);
  backdrop-filter:blur(10px);
  padding:20px;
  border-radius:18px;
  box-shadow:0 0 20px rgba(34,197,94,0.2);
  text-align:center;
}

.avatar{
  width:80px;
  height:80px;
  border-radius:50%;
  border:3px solid #22c55e;
  margin-bottom:10px;
}

.username{
  font-size:16px;
  font-weight:bold;
}

.badge{
  background:gold;
  color:black;
  font-size:11px;
  padding:3px 8px;
  border-radius:20px;
  font-weight:bold;
  display:none;
  margin-left:6px;
}

.uid{
  font-size:11px;
  opacity:.6;
  margin-top:5px;
  word-break:break-all;
}

/* ===============================
   INFO CARDS
================================ */

.info{
  margin:15px;
}

.info-card{
  background:rgba(255,255,255,0.05);
  padding:15px;
  border-radius:15px;
  margin-bottom:12px;
  box-shadow:0 0 15px rgba(34,197,94,0.15);
}

.label{
  font-size:12px;
  opacity:.6;
}

.value{
  font-size:18px;
  font-weight:bold;
  margin-top:4px;
}

/* ===============================
   BUTTONS
================================ */

.btn{
  width:90%;
  margin:10px auto;
  display:block;
  padding:12px;
  border:none;
  border-radius:25px;
  font-weight:bold;
  cursor:pointer;
  font-size:14px;
}

.logout{
  background:#dc2626;
  color:white;
}

.copy{
  background:#1e293b;
  color:#22c55e;
}

/* ===============================
   LOADING
================================ */

#loading{
  position:fixed;
  width:100%;
  height:100%;
  background:rgba(0,0,0,.6);
  display:none;
  justify-content:center;
  align-items:center;
  z-index:999;
}

.loader{
  border:4px solid #1e293b;
  border-top:4px solid #22c55e;
  border-radius:50%;
  width:40px;
  height:40px;
  animation:spin 1s linear infinite;
}

@keyframes spin{
  0%{transform:rotate(0)}
  100%{transform:rotate(360deg)}
}

/* ===============================
   BOTTOM NAV
================================ */

.bottom-nav{
  position:fixed;
  bottom:0;
  width:100%;
  background:#0f172a;
  display:flex;
  justify-content:space-around;
  padding:12px 0;
  border-top:1px solid #1e293b;
}

.nav-btn{
  color:#64748b;
  font-size:12px;
  text-align:center;
  cursor:pointer;
  transition:.3s;
  position:relative;
}

.nav-btn.active{
  color:#22c55e;
  transform:scale(1.1);
}

.nav-btn.active::after{
  content:"";
  position:absolute;
  bottom:-6px;
  left:50%;
  transform:translateX(-50%);
  width:20px;
  height:3px;
  background:#22c55e;
  border-radius:5px;
}

</style>
</head>

<body>

<div class="header">üë§ My Profile</div>

<div class="profile-card">
  <img src="https://i.pravatar.cc/150" class="avatar">
  <div class="username">
    <span id="email">Loading...</span>
    <span class="badge" id="premiumBadge">PREMIUM</span>
  </div>
  <div class="uid" id="uidText"></div>
</div>

<div class="info">

  <div class="info-card">
    <div class="label">Wallet Balance</div>
    <div class="value" id="wallet">‚Çπ 0</div>
  </div>

  <div class="info-card">
    <div class="label">Bonus Balance</div>
    <div class="value" id="bonus">‚Çπ 0</div>
  </div>

  <div class="info-card">
    <div class="label">Withdrawable</div>
    <div class="value" id="withdraw">‚Çπ 0</div>
  </div>

  <div class="info-card">
    <div class="label">FCM Token</div>
    <div class="value" id="fcmToken" style="font-size:10px;word-break:break-all;"></div>
  </div>

</div>

<button class="btn copy" onclick="copyUID()">Copy UID</button>
<button class="btn logout" onclick="logout()">Logout</button>

<div id="loading"><div class="loader"></div></div>

<!-- Bottom Nav -->
<div class="bottom-nav">
  <div class="nav-btn" onclick="goPage('dashboard.html',this)">üè†<br>Home</div>
  <div class="nav-btn" onclick="goPage('wallet.html',this)">üí∞<br>Wallet</div>
  <div class="nav-btn active">üë§<br>Profile</div>
</div>

<script type="module">

import { initializeApp } from 
"https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";

import { getAuth, onAuthStateChanged, signOut } 
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

import { getDatabase, ref, onValue } 
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyDsJUtZdIXcsB0w_2MQhMBXxIgbI3ijOvg",
  authDomain: "incoinpaysliveearning.firebaseapp.com",
  databaseURL: "https://incoinpaysliveearning-default-rtdb.firebaseio.com",
  projectId: "incoinpaysliveearning",
  storageBucket: "incoinpaysliveearning.firebasestorage.app",
  messagingSenderId: "971873814750",
  appId: "1:971873814750:web:7418c7da119e4725ed9a4f"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getDatabase(app);

const loading=document.getElementById("loading");

onAuthStateChanged(auth,(user)=>{

  if(!user){
    window.location.href="login.html";
    return;
  }

  loading.style.display="flex";

  document.getElementById("email").innerText=user.email;
  document.getElementById("uidText").innerText="UID: "+user.uid;

  onValue(ref(db,"users/"+user.uid),(snap)=>{

    if(!snap.exists()) return;

    const data=snap.val();

    document.getElementById("wallet").innerText="‚Çπ "+(data.wallet||0);
    document.getElementById("bonus").innerText="‚Çπ "+(data.bonus||0);
    document.getElementById("withdraw").innerText="‚Çπ "+(data.withdrawable||0);
    document.getElementById("fcmToken").innerText=data.fcmToken||"Not Available";

    if(data.premium===true){
      document.getElementById("premiumBadge").style.display="inline-block";
    }

    loading.style.display="none";

  });

});

window.logout=function(){
  signOut(auth).then(()=>{
    window.location.href="login.html";
  });
}

window.copyUID=function(){
  const uid=document.getElementById("uidText").innerText;
  navigator.clipboard.writeText(uid);
  alert("UID Copied!");
}

window.goPage=function(page,el){
  setTimeout(()=>{window.location.href=page},150);
}

</script>

</body>
</html>
